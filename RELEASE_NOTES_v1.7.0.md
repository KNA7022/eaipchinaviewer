# EAIP China Viewer v1.7.0 更新公告

## 版本信息
- **版本号**: v1.7.0+10
- **发布日期**: 2024年12月
- **更新类型**: 功能增强与优化

## 🚀 主要更新内容

### 1. 平台差异化更新机制
- **Windows平台**: 实现专用更新流程，用户将直接跳转到下载页面
- **Android平台**: 保持原有APK自动下载安装机制
- **配置文件分离**: 支持不同平台使用独立的版本配置文件
  - Windows: `version_windows.json`
  - Android: `version_android.json`
  - 通用: `version.json`

### 2. 缓存管理系统全面优化
- **PDF缓存清理**: 修复PDF缓存无法正确清除的问题
- **全面缓存清理**: 新增对应用缓存目录和支持目录的清理
- **智能缓存统计**: 增强缓存统计功能，显示更详细的缓存信息
  - PDF文件缓存数量
  - 其他偏好设置缓存
  - 应用缓存目录文件
- **旧版本缓存清理**: 解决旧应用版本遗留缓存问题

### 3. 用户界面改进
- **缓存统计显示**: 设置页面新增详细的缓存统计信息
- **清理反馈**: 优化缓存清理操作的用户反馈

## 🔧 技术改进

### 缓存服务优化
- 新增 `_clearPdfCache()` 方法，专门处理PDF缓存清理
- 新增 `_clearAppCache()` 方法，清理应用缓存和支持目录
- 改进 `getCacheStats()` 方法，提供更全面的缓存统计
- 优化 `SharedPreferences` 清理逻辑，保留重要设置

### 更新服务重构
- 实现平台检测机制，根据运行平台选择对应的更新URL
- 分离Windows和Android的更新处理逻辑
- 新增 `_handleWindowsUpdate()` 和 `_handleAndroidUpdate()` 方法

## 📱 平台兼容性
- ✅ Android 7.0+
- ✅ Windows 10+
- ✅ 跨平台缓存管理
- ✅ 平台特定更新机制

## 🛠️ 开发者说明

### 更新配置指南
开发者需要在服务器上配置以下JSON文件：

1. **version_windows.json** - Windows平台更新配置
2. **version_android.json** - Android平台更新配置
3. **version.json** - 通用更新配置（向后兼容）

详细配置说明请参考 `UPDATE_CONFIG_GUIDE.md` 文件。

### 缓存目录结构
```
应用缓存目录/
├── pdfs/           # PDF文件缓存
├── temp/           # 临时文件
└── 其他应用缓存文件

应用支持目录/
└── eaipchinaviewer/  # 旧版本数据目录
```

## 🐛 问题修复
- 修复PDF缓存无法清除的问题
- 修复旧版本应用数据残留问题
- 优化缓存统计准确性
- 改进跨平台更新体验

## 📋 升级建议
- **Android用户**: 应用将自动提示更新，支持一键安装
- **Windows用户**: 更新时将跳转到下载页面，请手动下载安装
- **首次更新后**: 建议执行一次"清除缓存"操作，清理旧版本数据

## 🔄 向后兼容性
- 完全兼容现有用户数据和设置
- 自动迁移旧版本配置
- 保留用户主题、认证和个人设置

---

**感谢您使用 EAIP China Viewer！**

如有问题或建议，请通过以下方式联系我们：
- GitHub Issues
- 应用内反馈功能

*本次更新专注于提升用户体验和系统稳定性，为不同平台用户提供更好的使用体验。*